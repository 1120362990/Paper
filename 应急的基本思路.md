# 应急的基本流程

注意在整个个过程中不要被客户或现场的运维人员误导。
操作前需先征得客户许可。
因实际的应急情况会比较复杂，因此需根据实际情况进行灵活处置。

## 1.了解情况

1. 发生时间：询问客户发现异常事件的具体时间，后续的操作要基于此时间点进行追踪分析。
2. 受影响系统类型：询问具体的操作系统类型，以便后续的应急处置。
    - windows/linux
    - 财务系统/OA系统/官网等
3. 异常情况：
    - 文件被加密
    - 设备无法正常启动
    - 勒索信息展示
    - CPU利用率过高
    - 网页挂马/黑链
    - 对外发送异常请求
    - 等非正常的情况
4. 已有的处置措施：
    - 之前是否存在此类问题
    - 是否在出现问题后配置了新的策略
    - 是否已有第三方已进行了应急处理，处理结果是什么
    - 是否有其他处置措施
5. 系统架构/网络拓扑：是否能提供网络拓扑图
6. 能否提供以下日志
    - 服务器日志
    - 应用日志，重点web日志
    - 数据库日志
7. 已有的安全设备
    - 终端杀软
    - 防火墙
    - WAF
    - 流量分析设备
8. 基本的应急处置方案
    - 临时处置方案
    - 勒索病毒处置方案
    - 挖矿程序处置预案
    - 网页挂马处置预案
    - DDOS处置预案
    - 内部数据泄露处置预案
    - 其他处置预案

## 2. 遏制传播风险

- 禁止被感染主机使用U盘，移动硬盘。如必须使用做好备份
- 禁用所有无线/有线网卡或直接拔网线
- 关闭相关端口
- 划分隔离网络区域
- 封存主机，相关数据备份
- 被感染主机应用服务下线
- 被感染主机部分功能暂停
- 被感染主机相关账号降权

## 3.已知高危漏洞排查

    可与下面的步骤同时进行，扫描高危漏洞。但要注意扫描产生的大量日志不要影响漏洞排查

## 4.系统基本信息

## 5.异常连接排查

## 6.正在运行的异常进程排查

## 7.异常账号排查

## 8.异常文件分析

## 9.启动项排查

## 10.计划任务排查(定时任务)

## 11.日志排查

## 12.恢复阶段

- 此阶段以客户为主，仅提供建议

1. webshell/异常文件清除
    - 相关样本取样截图留存
2. 恢复网络
3. 应用功能恢复
4. 补丁升级
5. 提供安全加固措施，推荐切合的安全产品

## 13.跟踪总结

1. 分析事件原因
    - 攻击来源，IP
    - 攻击行为分析，弱口令、可以导致命令执行的漏洞等
2. 输出应急报告
3. 事后观察
4. 提供加固建议